<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>k8s的疑难杂症 - 运维个人技术栈</title><meta name=Description content="这里记录处理 [[笔记/point/k8s|k8s]] 的常见问题."><meta property="og:title" content="k8s的疑难杂症"><meta property="og:description" content="这里记录处理 [[笔记/point/k8s|k8s]] 的常见问题."><meta property="og:type" content="article"><meta property="og:url" content="https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-28T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-08T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="k8s的疑难杂症"><meta name=twitter:description content="这里记录处理 [[笔记/point/k8s|k8s]] 的常见问题."><meta name=application-name content="kentxxq"><meta name=apple-mobile-web-app-title content="kentxxq"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/><link rel=prev href=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/point/kubesphere/><link rel=next href=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/csharp%E5%AE%89%E8%A3%85/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"k8s的疑难杂症","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kentxxq.com\/posts\/%E7%AC%94%E8%AE%B0\/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87\/"},"genre":"posts","keywords":"blog, k8s","wordcount":1265,"url":"https:\/\/kentxxq.com\/posts\/%E7%AC%94%E8%AE%B0\/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87\/","datePublished":"2023-07-28T00:00:00+00:00","dateModified":"2023-12-08T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"kentxxq"},"description":"这里记录处理 [[笔记/point/k8s|k8s]] 的常见问题."}</script><script src=//instant.page/5.2.0 defer type=module integrity=sha384-jnZyxPjiipYXnSU0ygqeac2q7CVYMbh84q0uHVRRxEtvFPiQYbXWUorga2aqZJ0z></script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else""==="light"||""==="dark"||""==="black"?(setTheme(""),saveTheme("")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=运维个人技术栈>运维个人技术栈</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Blog </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=运维个人技术栈>运维个人技术栈</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>Blog</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#简介>简介</a></li><li><a href=#排错路线>排错路线</a></li><li><a href=#错误合集>错误合集</a><ul><li><a href=#metrics-server>metrics-server</a><ul><li><a href=#doesnt-contain-any-ip-sans>doesn&rsquo;t contain any IP SANs</a></li><li><a href=#kubectl-top-pod-报错-error-metrics-api-not-available>kubectl top pod 报错 error: Metrics API not available</a></li></ul></li><li><a href=#too-many-pods-容器启动失败>too many pods 容器启动失败</a></li><li><a href=#清理残存的容器>清理残存的容器</a></li><li><a href=#证书>证书</a></li><li><a href=#网络插件错误>网络插件错误</a><ul><li><a href=#multus>Multus</a></li><li><a href=#bgp>BGP</a></li></ul></li><li><a href=#cri-dockerd>cri-dockerd</a><ul><li><a href=#validate-cri-v-1-runtime-api-for-endpoint>validate CRI v 1 runtime API for endpoint</a></li><li><a href=#kubeadm-无法指定---cri-socket>kubeadm 无法指定 &ndash;cri-socket</a></li></ul></li></ul></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">k8s的疑难杂症</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=https://kentxxq.com title=Author target=_blank rel="noopener noreferrer author" class=author>kentxxq</a>
</span>&nbsp;<span class=post-category>收录于 </span>&nbsp;<span class=post-category>类别 <a href=/categories/blog/><i class="far fa-folder fa-fw"></i>blog</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2023-07-28>2023-07-28</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2023-12-08>2023-12-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 1265 字&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 3 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#简介>简介</a></li><li><a href=#排错路线>排错路线</a></li><li><a href=#错误合集>错误合集</a><ul><li><a href=#metrics-server>metrics-server</a><ul><li><a href=#doesnt-contain-any-ip-sans>doesn&rsquo;t contain any IP SANs</a></li><li><a href=#kubectl-top-pod-报错-error-metrics-api-not-available>kubectl top pod 报错 error: Metrics API not available</a></li></ul></li><li><a href=#too-many-pods-容器启动失败>too many pods 容器启动失败</a></li><li><a href=#清理残存的容器>清理残存的容器</a></li><li><a href=#证书>证书</a></li><li><a href=#网络插件错误>网络插件错误</a><ul><li><a href=#multus>Multus</a></li><li><a href=#bgp>BGP</a></li></ul></li><li><a href=#cri-dockerd>cri-dockerd</a><ul><li><a href=#validate-cri-v-1-runtime-api-for-endpoint>validate CRI v 1 runtime API for endpoint</a></li><li><a href=#kubeadm-无法指定---cri-socket>kubeadm 无法指定 &ndash;cri-socket</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=简介 class=headerLink><a href=#%e7%ae%80%e4%bb%8b class=header-mark></a>简介</h2><p>这里记录处理 <a href=/posts/%E7%AC%94%E8%AE%B0/point/k8s/>k8s</a> 的常见问题.</p><h2 id=排错路线 class=headerLink><a href=#%e6%8e%92%e9%94%99%e8%b7%af%e7%ba%bf class=header-mark></a>排错路线</h2><p><img src=/posts/%E9%99%84%E4%BB%B6/k8s%E6%8E%92%E9%94%99%E8%B7%AF%E7%BA%BF.jpg></p><h2 id=错误合集 class=headerLink><a href=#%e9%94%99%e8%af%af%e5%90%88%e9%9b%86 class=header-mark></a>错误合集</h2><h3 id=metrics-server class=headerLink><a href=#metrics-server class=header-mark></a>metrics-server</h3><h4 id=doesnt-contain-any-ip-sans class=headerLink><a href=#doesnt-contain-any-ip-sans class=header-mark></a>doesn&rsquo;t contain any IP SANs</h4><p>在 metrics-server 启动的 yml 文件中, 添加启动参数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>command</span><span class=p>:</span><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=l>/metrics-server  </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- --<span class=l>kubelet-insecure-tls</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h4 id=kubectl-top-pod-报错-error-metrics-api-not-available class=headerLink><a href=#kubectl-top-pod-%e6%8a%a5%e9%94%99-error-metrics-api-not-available class=header-mark></a>kubectl top pod 报错 error: Metrics API not available</h4><p>当你使用 <code>kubectl top pod</code> 来查看信息的时候, 需要安装 <code>Metrics-server</code>, <a href=https://github.com/kubernetes-sigs/metrics-server#installation target=_blank rel="noopener noreferrer">参考链接</a></p><ol><li><p>下载下来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml -o metrics-server.yaml
</span></span></code></pre></td></tr></table></div></div></li><li><p>因为多数都是自签名证书, 所以添加启动参数 <code>--kubelet-insecure-tls</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>k8s-app</span><span class=p>:</span><span class=w> </span><span class=l>metrics-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>metrics-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>kube-system</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>k8s-app</span><span class=p>:</span><span class=w> </span><span class=l>metrics-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>rollingUpdate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>maxUnavailable</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>k8s-app</span><span class=p>:</span><span class=w> </span><span class=l>metrics-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- --<span class=l>cert-dir=/tmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- --<span class=l>secure-port=4443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- --<span class=l>kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- --<span class=l>kubelet-use-node-status-port</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- --<span class=l>metric-resolution=15s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- --<span class=l>kubelet-insecure-tls</span><span class=w> </span><span class=c># 添加此行</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li></ol><h3 id=too-many-pods-容器启动失败 class=headerLink><a href=#too-many-pods-%e5%ae%b9%e5%99%a8%e5%90%af%e5%8a%a8%e5%a4%b1%e8%b4%a5 class=header-mark></a>too many pods 容器启动失败</h3><p>发现 <a href=/posts/%E7%AC%94%E8%AE%B0/point/kubesphere/>kubesphere</a> 的 cicd 容器无法启动, 于是排查容器 <code>kubectl describe pod/cicdrfbh9-pay-h5-35-gn0rf-pl1sr-g8tpr -n kubesphere-devops-worker</code> 提示 <code>too many pods</code>, 下面是操作方法.</p><p>完整顺序应该是</p><ol><li>先排水</li><li>不可调度</li><li>改配置, 重启</li><li>重新调度</li></ol><p>Kubelet 的启动配置通常是这样, 我们加上 <code>--max-pods=300</code> 然后重启 kubelet 服务即可.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-toml data-lang=toml><span class=line><span class=cl><span class=nx>Environment</span><span class=p>=</span><span class=s2>&#34;KUBELET_EXTRA_ARGS=--node-ip=10.30.1.127 --hostname-override=node1 --max-pods=300&#34;</span>
</span></span><span class=line><span class=cl><span class=nx>ExecStart</span><span class=p>=</span><span class=err>/</span><span class=nx>usr</span><span class=err>/</span><span class=nx>local</span><span class=err>/</span><span class=nx>bin</span><span class=err>/</span><span class=nx>kubelet</span> <span class=err>$</span><span class=nx>KUBELET_KUBECONFIG_ARGS</span> <span class=err>$</span><span class=nx>KUBELET_CONFIG_ARGS</span> <span class=err>$</span><span class=nx>KUBELET_KUBEADM_ARGS</span> <span class=err>$</span><span class=nx>KUBELET_EXTRA_ARGS</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=清理残存的容器 class=headerLink><a href=#%e6%b8%85%e7%90%86%e6%ae%8b%e5%ad%98%e7%9a%84%e5%ae%b9%e5%99%a8 class=header-mark></a>清理残存的容器</h3><p><a href=/posts/%E7%AC%94%E8%AE%B0/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%92%8C%E9%85%8D%E7%BD%AE/#%E6%B8%85%E7%90%86%E6%AE%8B%E5%AD%98%E5%AE%B9%E5%99%A8>笔记/k8s常用命令和配置#清理残存容器</a></p><h3 id=证书 class=headerLink><a href=#%e8%af%81%e4%b9%a6 class=header-mark></a>证书</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查找证书</span>
</span></span><span class=line><span class=cl>find / -name apiserver.crt
</span></span><span class=line><span class=cl>/etc/kubernetes/pki/apiserver.crt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看证书过期时间</span>
</span></span><span class=line><span class=cl>openssl x509 -in /etc/kubernetes/pki/apiserver.crt -noout -dates
</span></span><span class=line><span class=cl><span class=nv>notBefore</span><span class=o>=</span>Apr <span class=m>22</span> 06:54:59 <span class=m>2022</span> GMT
</span></span><span class=line><span class=cl><span class=nv>notAfter</span><span class=o>=</span>Apr  <span class=m>1</span> 19:00:00 <span class=m>2024</span> GMT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># kuadm查看证书状态</span>
</span></span><span class=line><span class=cl>kubeadm certs check-expiration
</span></span></code></pre></td></tr></table></div></div><h3 id=网络插件错误 class=headerLink><a href=#%e7%bd%91%e7%bb%9c%e6%8f%92%e4%bb%b6%e9%94%99%e8%af%af class=header-mark></a>网络插件错误</h3><h4 id=multus class=headerLink><a href=#multus class=header-mark></a>Multus</h4><p>网络插件的报错, 会出现如下的关键字:</p><p><code>network: Multus</code> &mldr; <code>KillPodSandbox</code>&mldr; <code>Unauthorized</code>&mldr; <code>networkPlugin cni failed</code></p><p>我们在安装网络插件的时候, 只不过是通过 <code>kubectl create/edit</code> 操作了一些资源, 所以我们重启等操作不会造成其他的影响. 在官方也有不少这样的骚操作, 比如 <a href=https://github.com/projectcalico/calico/issues/5712 target=_blank rel="noopener noreferrer">这个帖子的答案推荐直接尝试重启</a> &mldr;.</p><p>操作流程</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 查找插件calico,flannal之类的</span>
</span></span><span class=line><span class=cl>kubectl get all -A <span class=p>|</span>grep cali
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 杀死重启</span>
</span></span><span class=line><span class=cl>kubectl delete pod/calico-node-xxx -n 命名空间
</span></span><span class=line><span class=cl>kubectl delete pod/kube-multus-ds-xxx -n 命名空间
</span></span></code></pre></td></tr></table></div></div><h4 id=bgp class=headerLink><a href=#bgp class=header-mark></a>BGP</h4><p>网络插件的报错类似于</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>calico/node is not ready:
</span></span><span class=line><span class=cl>BIRD is not ready:BGP not established with 192.168.200.129,192.168.200.130
</span></span><span class=line><span class=cl>Number of node<span class=o>(</span>s<span class=o>)</span>with BGP peering <span class=nv>established</span> <span class=o>=</span><span class=m>0</span>
</span></span></code></pre></td></tr></table></div></div><p><code>calico</code> 通常会根据第一个网卡来配置信息. 而出现上面的报错, 就说明我们<strong>没有找到正确的网卡, 没有配置正确的 ip 信息</strong>.</p><p>解决:</p><ol><li><p><code>ip a</code> 查看我们需要用到的网卡名称. 例如 <code>eth0</code>, <code>ens33</code> 等等</p></li><li><p>修改 <code>vim calico.yaml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=c># 增加内容</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>IP_AUTODETECTION_METHOD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;interface=en*&#34;</span><span class=w> </span><span class=c># 也可以写死 &#34;interface=eth0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># 下面是原文件内容</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>CLUSTER_TYPE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;k8s,bgp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>IP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;autodetect&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>CALICO_IPV4POOL_IPIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Always&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div></li><li><p>重新部署 <code>kubectl apply -f calico.yaml</code></p></li></ol><h3 id=cri-dockerd class=headerLink><a href=#cri-dockerd class=header-mark></a>cri-dockerd</h3><h4 id=validate-cri-v-1-runtime-api-for-endpoint class=headerLink><a href=#validate-cri-v-1-runtime-api-for-endpoint class=header-mark></a>validate CRI v 1 runtime API for endpoint</h4><p>情景：</p><p><code>kubeadm init</code> 或 <code>crictl ps</code> 的时候报错：</p><p><code>validate CRI v1 runtime API for endpoint "unix:///var/run/cri-dockerd.sock"</code></p><p>解答：</p><ul><li>网上很多的教程都有一定的滞后性。如果无法保证所有组件的版本，架构一致，可能会出现问题。包括但不限于：<a href=/posts/%E7%AC%94%E8%AE%B0/point/k8s/>k8s</a> 版本，cni 版本，docker 版本，containerd 版本，arm 架构， x 86 架构等等。</li><li>cri-dockerd 是为了不停兼容 cri 标准。所以 cri-dockerd 和 <a href=/posts/%E7%AC%94%E8%AE%B0/point/k8s/>k8s</a> 的版本兼容性比较好。而 dockerd 的内部 api 可能会经常变动，比如下图 cri-dockerd 的 <code>v0.3.8</code> 开始兼容 <a href=/posts/%E7%AC%94%E8%AE%B0/point/docker/>docker</a> 的 <code>v24.0.7</code> 版本 <img src=/posts/%E9%99%84%E4%BB%B6/cri-dockerd%E5%85%BC%E5%AE%B9docker%E7%89%88%E6%9C%AC.png></li></ul><p>处理:</p><ol><li><p><strong>建议下载最新</strong>的 cri-dockerd 版本，配置 cri-dockerd：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># 获取软件</span>
</span></span><span class=line><span class=cl>mkdir /data/softs <span class=o>&amp;&amp;</span> <span class=nb>cd</span> /data/softs
</span></span><span class=line><span class=cl>wget https://github.com/Mirantis/cri-dockerd/releases/download/v0.2.1/cri-dockerd-0.3.8.amd64.tgz
</span></span><span class=line><span class=cl><span class=c1># 解压软件</span>
</span></span><span class=line><span class=cl>tar xf cri-dockerd-0.3.8.amd64.tgz
</span></span><span class=line><span class=cl>mv cri-dockerd/cri-dockerd /usr/local/bin/
</span></span><span class=line><span class=cl><span class=c1># 检查效果</span>
</span></span><span class=line><span class=cl>cri-dockerd --version
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 守护进程</span>
</span></span><span class=line><span class=cl>vim /etc/systemd/system/cri-dockerd.service
</span></span><span class=line><span class=cl><span class=o>[</span>Unit<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Description</span><span class=o>=</span>CRI Interface <span class=k>for</span> Docker Application Container Engine
</span></span><span class=line><span class=cl><span class=nv>Documentation</span><span class=o>=</span>https://docs.mirantis.com
</span></span><span class=line><span class=cl><span class=nv>After</span><span class=o>=</span>network-online.target firewalld.service docker.service
</span></span><span class=line><span class=cl><span class=nv>Wants</span><span class=o>=</span>network-online.target
</span></span><span class=line><span class=cl><span class=o>[</span>Service<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Type</span><span class=o>=</span>notify
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/local/bin/cri-dockerd --network-plugin<span class=o>=</span>cni --cni-conf-dir<span class=o>=</span>/etc/cni/net.d --cni-bin-dir<span class=o>=</span>/opt/cni/bin --container-runtime-endpoint<span class=o>=</span>unix:///var/run/cri-dockerd.sock --image-pull-progress-deadline<span class=o>=</span>30s --pod-infra-container-image<span class=o>=</span>registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.6 --cri-dockerd-root-directory<span class=o>=</span>/var/lib/dockershim --docker-endpoint<span class=o>=</span>unix:///var/run/docker.sock --cri-dockerd-root-directory<span class=o>=</span>/var/lib/docker
</span></span><span class=line><span class=cl><span class=nv>ExecReload</span><span class=o>=</span>/bin/kill -s HUP <span class=nv>$MAINPID</span>
</span></span><span class=line><span class=cl><span class=nv>TimeoutSec</span><span class=o>=</span><span class=m>0</span>
</span></span><span class=line><span class=cl><span class=nv>RestartSec</span><span class=o>=</span><span class=m>2</span>
</span></span><span class=line><span class=cl><span class=nv>Restart</span><span class=o>=</span>always
</span></span><span class=line><span class=cl><span class=nv>StartLimitBurst</span><span class=o>=</span><span class=m>3</span>
</span></span><span class=line><span class=cl><span class=nv>StartLimitInterval</span><span class=o>=</span>60s
</span></span><span class=line><span class=cl><span class=nv>LimitNOFILE</span><span class=o>=</span>infinity
</span></span><span class=line><span class=cl><span class=nv>LimitNPROC</span><span class=o>=</span>infinity
</span></span><span class=line><span class=cl><span class=nv>LimitCORE</span><span class=o>=</span>infinity
</span></span><span class=line><span class=cl><span class=nv>TasksMax</span><span class=o>=</span>infinity
</span></span><span class=line><span class=cl><span class=nv>Delegate</span><span class=o>=</span>yes
</span></span><span class=line><span class=cl><span class=nv>KillMode</span><span class=o>=</span>process
</span></span><span class=line><span class=cl><span class=o>[</span>Install<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>WantedBy</span><span class=o>=</span>multi-user.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vim /usr/lib/systemd/system/cri-dockerd.socket
</span></span><span class=line><span class=cl><span class=o>[</span>Unit<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Description</span><span class=o>=</span>CRI Docker Socket <span class=k>for</span> the API
</span></span><span class=line><span class=cl><span class=nv>PartOf</span><span class=o>=</span>cri-docker.service
</span></span><span class=line><span class=cl><span class=o>[</span>Socket<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ListenStream</span><span class=o>=</span>/var/run/cri-dockerd.sock
</span></span><span class=line><span class=cl><span class=nv>SocketMode</span><span class=o>=</span><span class=m>0660</span>
</span></span><span class=line><span class=cl><span class=nv>SocketUser</span><span class=o>=</span>root
</span></span><span class=line><span class=cl><span class=nv>SocketGroup</span><span class=o>=</span>docker
</span></span><span class=line><span class=cl><span class=o>[</span>Install<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>WantedBy</span><span class=o>=</span>sockets.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 启动服务</span>
</span></span><span class=line><span class=cl>systemctl daemon-reload
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> cri-dockerd.service
</span></span><span class=line><span class=cl>systemctl restart cri-dockerd.service
</span></span><span class=line><span class=cl><span class=c1># 检测效果</span>
</span></span><span class=line><span class=cl>crictl --runtime-endpoint /var/run/cri-dockerd.sock ps
</span></span></code></pre></td></tr></table></div></div></li><li><p><code>vim /etc/containerd/config.toml</code> <strong>去除</strong> <code>disabled_plugins = ["cri"]</code>. 重启 <a href=/posts/%E7%AC%94%E8%AE%B0/point/Containerd/>Containerd</a> <code>systemctl restart containerd</code></p></li><li><p>测试是否可以通过 cri-dockerd 联通 docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># cat /etc/crictl.yaml</span>
</span></span><span class=line><span class=cl>runtime-endpoint: <span class=s2>&#34;unix:///var/run/cri-dockerd.sock&#34;</span>
</span></span><span class=line><span class=cl>image-endpoint: <span class=s2>&#34;unix:///var/run/cri-dockerd.sock&#34;</span>
</span></span><span class=line><span class=cl>timeout: <span class=m>10</span>
</span></span><span class=line><span class=cl>debug: <span class=nb>false</span>
</span></span><span class=line><span class=cl>pull-image-on-create: <span class=nb>true</span>
</span></span><span class=line><span class=cl>disable-pull-on-run: <span class=nb>false</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 测试效果</span>
</span></span><span class=line><span class=cl>crictl ps
</span></span></code></pre></td></tr></table></div></div></li></ol><h4 id=kubeadm-无法指定---cri-socket class=headerLink><a href=#kubeadm-%e6%97%a0%e6%b3%95%e6%8c%87%e5%ae%9a---cri-socket class=header-mark></a>kubeadm 无法指定 &ndash;cri-socket</h4><p>准备一个配置文件 <code>kube-init.yaml</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yml data-lang=yml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>kubeadm.k8s.io/v1beta3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>InitConfiguration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>nodeRegistration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>criSocket</span><span class=p>:</span><span class=w> </span><span class=l>unix:///var/run/cri-dockerd.sock</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p>引入配置文件即可：</p><p><code>kubeadm init phase upload-certs --upload-certs --config kube-init.yml</code></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2023-12-08</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><button title="分享到 Twitter" data-sharer=twitter data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症 data-hashtags=blog,k8s><span class="fab fa-twitter fa-fw"></span></button><button title="分享到 Facebook" data-sharer=facebook data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-hashtag=blog><span class="fab fa-facebook-square fa-fw"></span></button><button title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症 data-web><span class="fab fa-whatsapp fa-fw"></span></button><button title="分享到 Line" data-sharer=line data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症><span data-svg-src=/lib/simple-icons/icons/line.min.svg></span></button><button title="分享到 微博" data-sharer=weibo data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症><span class="fab fa-weibo fa-fw"></span></button><button title="分享到 Myspace" data-sharer=myspace data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症 data-description="这里记录处理 [[笔记/point/k8s|k8s]] 的常见问题."><span data-svg-src=/lib/simple-icons/icons/myspace.min.svg></span></button><button title="分享到 Blogger" data-sharer=blogger data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症 data-description="这里记录处理 [[笔记/point/k8s|k8s]] 的常见问题."><span class="fab fa-blogger fa-fw"></span></button><button title="分享到 Evernote" data-sharer=evernote data-url=https://kentxxq.com/posts/%E7%AC%94%E8%AE%B0/k8s%E7%9A%84%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/ data-title=k8s的疑难杂症><span class="fab fa-evernote fa-fw"></span></button></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/blog/>blog</a>,&nbsp;<a href=/tags/k8s/>k8s</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/%E7%AC%94%E8%AE%B0/point/kubesphere/ class=prev rel=prev title=kubesphere><i class="fas fa-angle-left fa-fw"></i>kubesphere</a>
<a href=/posts/%E7%AC%94%E8%AE%B0/csharp%E5%AE%89%E8%A3%85/ class=next rel=next title=csharp安装>csharp安装<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>1993 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://kentxxq.com target=_blank rel="noopener noreferrer">kentxxq</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a> | <a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=43010402000934"><img src=/备案图标.png style=display:inline-block>湘公网安备 43010402000934号</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp><a target=_blank href=https://beian.miit.gov.cn>湘ICP备2021002319号-1</a></span></div><div class=footer-line></div><div class=footer-line></div></div><script>"serviceWorker"in navigator&&(navigator.serviceWorker.register("/sw.min.js",{scope:"/"}).then(function(){}),navigator.serviceWorker.ready.then(function(){}))</script></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/copy-tex.min.css><noscript><link rel=stylesheet href=/lib/katex/copy-tex.min.css></noscript><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:18},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,type:"fuse",useExtendedSearch:!1},sharerjs:!0,twemoji:!0}</script><script type=text/javascript src=/lib/twemoji/twemoji.min.js defer></script><script type=text/javascript src=/js/twemoji.min.js defer></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js defer></script><script type=text/javascript src=/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/js/katex.min.js defer></script><script type=text/javascript src=/js/theme.min.js defer></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NLLDC353PJ",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=G-NLLDC353PJ" async></script></div></body></html>