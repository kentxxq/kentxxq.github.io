<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title class=pjax-title>csv转xlsx文件 - kentxxq Blog</title><meta name=Description content="我的超级多学习资料，都是通过书签来进行保存的。之前说过好好理一理python，所以打算从python书签开始。python的性能一直被诟病，有多方面的原因。而多进程是解决办法之一"><meta property="og:title" content="csv转xlsx文件"><meta property="og:description" content="我的超级多学习资料，都是通过书签来进行保存的。之前说过好好理一理python，所以打算从python书签开始。python的性能一直被诟病，有多方面的原因。而多进程是解决办法之一"><meta property="og:type" content="article"><meta property="og:url" content="https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-12-17T11:45:00+08:00"><meta property="article:modified_time" content="2021-08-23T00:57:19+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="csv转xlsx文件"><meta name=twitter:description content="我的超级多学习资料，都是通过书签来进行保存的。之前说过好好理一理python，所以打算从python书签开始。python的性能一直被诟病，有多方面的原因。而多进程是解决办法之一"><meta name=application-name content="kentxxq"><meta name=apple-mobile-web-app-title content="kentxxq"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/><link rel=prev href=https://kentxxq.com/contents/%E6%88%91%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%94%B5%E5%AD%90%E4%BA%A7%E5%93%81%E8%B7%AF%E7%BA%BF/><link rel=next href=https://kentxxq.com/contents/centos8%E7%9A%84%E8%AE%B0%E5%BD%95/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload="this.onload=null,this.rel='stylesheet'" href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload="this.onload=null,this.rel='stylesheet'" href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"csv转xlsx文件","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kentxxq.com\/contents\/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6\/"},"genre":"posts","keywords":"python, c#","wordcount":1079,"url":"https:\/\/kentxxq.com\/contents\/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6\/","datePublished":"2019-12-17T11:45:00+08:00","dateModified":"2021-08-23T00:57:19+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"kentxxq"},"description":"我的超级多学习资料，都是通过书签来进行保存的。之前说过好好理一理python，所以打算从python书签开始。python的性能一直被诟病，有多方面的原因。而多进程是解决办法之一"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute('theme',e)}function saveTheme(e){window.localStorage&&localStorage.setItem('theme',e)}function getMeta(t){const e=document.getElementsByTagName('meta');for(let n=0;n<e.length;n++)if(e[n].getAttribute('name')===t)return e[n];return''}if(window.localStorage&&localStorage.getItem('theme')){let e=localStorage.getItem('theme');e==='light'||e==='dark'||e==='black'?setTheme(e):window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches?setTheme('dark'):setTheme('light')}else''==='light'||''==='dark'||''==='black'?(setTheme(''),saveTheme('')):(saveTheme('auto'),window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches?setTheme('dark'):setTheme('light'));let metaColors={light:'#f8f8f8',dark:'#252627',black:'#000000'};getMeta('theme-color').content=metaColors[document.body.getAttribute('theme')]</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="kentxxq Blog">kentxxq Blog</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Blog </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="kentxxq Blog">kentxxq Blog</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=# onclick=return!1 class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=# onclick=return!1 class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=# onclick=return!1 class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>Blog</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/about/ title>About</a><a href=# onclick=return!1 class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#python代码>python代码</a><ul><li><a href=#pyexcel版本>pyexcel版本</a></li><li><a href=#pyexcelerate版本>pyexcelerate版本</a></li></ul></li><li><a href=#c代码>c#代码</a><ul><li><a href=#epplus版本>epplus版本</a></li></ul></li><li><a href=#最后对比>最后对比</a></li><li><a href=#总结>总结</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("pageStyle","wide")</script><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">csv转xlsx文件</h1><div class=post-meta><div class=post-meta-line><span class=post-author><i class="author fas fa-user-circle fa-fw"></i><a href=https://kentxxq.com title=Author target=_blank rel="noopener noreffer author" class=author>kentxxq</a>
</span>&nbsp;<span class=post-category>收录于 </span>&nbsp;<span class=post-category>类别 <a href=/categories/%E7%AC%94%E8%AE%B0/><i class="far fa-folder fa-fw"></i>笔记</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2019-12-17>2019-12-17</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2021-08-23>2021-08-23</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 1079 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 3 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#python代码>python代码</a><ul><li><a href=#pyexcel版本>pyexcel版本</a></li><li><a href=#pyexcelerate版本>pyexcelerate版本</a></li></ul></li><li><a href=#c代码>c#代码</a><ul><li><a href=#epplus版本>epplus版本</a></li></ul></li><li><a href=#最后对比>最后对比</a></li><li><a href=#总结>总结</a></li></ul></nav></div></div><div class=content id=content><blockquote><p>Excel是大家办公最常遇到的文件之一。一旦需要具体数据的时候，客户都要求这个文件。</p><p>而我用plsql从oracle数据库中查出来以后，一般都是直接导出csv文件。需要手动去wps导入csv，转换成xlsx文件。有时候文件实在是太多了，麻烦。</p><p>于是就有了这个文章。</p></blockquote><h2 id=python代码 class=headerLink><a href=#python%e4%bb%a3%e7%a0%81 class=header-mark></a>python代码</h2><h3 id=pyexcel版本 class=headerLink><a href=#pyexcel%e7%89%88%e6%9c%ac class=header-mark></a>pyexcel版本</h3><p>这个版本代码最简单的，缺点就是非常慢。100W行的数据[1,2,3,4][2,3,4,5]&mldr;需要2分钟！</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 你还需要安装pyexcel-xlsx</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyexcel</span> <span class=kn>import</span> <span class=n>get_sheet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sheet</span> <span class=o>=</span> <span class=n>get_sheet</span><span class=p>(</span><span class=n>file_name</span><span class=o>=</span><span class=s1>&#39;/Users/kentxxq/test.csv&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sheet</span><span class=o>.</span><span class=n>save_as</span><span class=p>(</span><span class=n>filename</span><span class=o>=</span><span class=s1>&#39;/Users/kentxxq/test.xlsx&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>sheet</span><span class=o>.</span><span class=n>number_of_rows</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;ok&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=pyexcelerate版本 class=headerLink><a href=#pyexcelerate%e7%89%88%e6%9c%ac class=header-mark></a>pyexcelerate版本</h3><p>这个看了一个它在测试，确实很快。大概60s。还是不太理想。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pyexcelerate</span> <span class=kn>import</span> <span class=n>Workbook</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>csv</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>multiprocessing.pool</span> <span class=kn>import</span> <span class=n>Pool</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>csv_to_xlsx</span><span class=p>(</span><span class=n>file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;开始处理:&#39;</span><span class=o>+</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>file</span><span class=p>)[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>file</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;gbk&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>lines</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>csv</span><span class=o>.</span><span class=n>reader</span><span class=p>(</span><span class=n>f</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>wb</span> <span class=o>=</span> <span class=n>Workbook</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>wb</span><span class=o>.</span><span class=n>new_sheet</span><span class=p>(</span><span class=s1>&#39;sheet1&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>wb</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>file</span> <span class=o>+</span> <span class=s1>&#39;.xlsx&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>duration</span> <span class=o>=</span> <span class=n>end</span><span class=o>-</span><span class=n>start</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>file</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=s1>&#39;处理完成:&#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>duration</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;秒&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>folder</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)</span> <span class=ow>or</span> <span class=s1>&#39;.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>folder</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;处理开始---------------------------------------&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span> <span class=o>=</span> <span class=n>Pool</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>root</span><span class=p>,</span> <span class=n>dirs</span><span class=p>,</span> <span class=n>files</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>folder</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>name</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>splitext</span><span class=p>(</span><span class=n>name</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;.csv&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>url</span> <span class=o>=</span> <span class=n>root</span> <span class=o>+</span> <span class=s1>&#39;/&#39;</span> <span class=o>+</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>                <span class=n>p</span><span class=o>.</span><span class=n>apply_async</span><span class=p>(</span><span class=n>csv_to_xlsx</span><span class=p>,</span> <span class=n>args</span><span class=o>=</span><span class=p>(</span><span class=n>url</span><span class=p>,))</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>p</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>duration</span> <span class=o>=</span> <span class=n>end</span><span class=o>-</span><span class=n>start</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;处理完成---------------------------------------&#39;</span><span class=o>+</span><span class=nb>str</span><span class=p>(</span><span class=n>duration</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=c代码 class=headerLink><a href=#c%e4%bb%a3%e7%a0%81 class=header-mark></a>c#代码</h2><h3 id=epplus版本 class=headerLink><a href=#epplus%e7%89%88%e6%9c%ac class=header-mark></a>epplus版本</h3><p>这个我只用了很少的代码，但是只花了18s左右！</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=kt>var</span> <span class=n>format</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ExcelTextFormat</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>format</span><span class=p>.</span><span class=n>Delimiter</span> <span class=p>=</span> <span class=sc>&#39;,&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>format</span><span class=p>.</span><span class=n>EOL</span> <span class=p>=</span> <span class=s>&#34;\n&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>pck</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ExcelPackage</span><span class=p>(</span><span class=k>new</span> <span class=n>FileInfo</span><span class=p>(</span><span class=s>@&#34;/Users/kentxxq/xxxx.xlsx&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>sheet</span> <span class=p>=</span> <span class=n>pck</span><span class=p>.</span><span class=n>Workbook</span><span class=p>.</span><span class=n>Worksheets</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;Test1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>sheet</span><span class=p>.</span><span class=n>Cells</span><span class=p>[</span><span class=s>&#34;A1&#34;</span><span class=p>].</span><span class=n>LoadFromText</span><span class=p>(</span><span class=k>new</span> <span class=n>FileInfo</span><span class=p>(</span><span class=s>@&#34;/Users/kentxxq/test.csv&#34;</span><span class=p>),</span> <span class=n>format</span><span class=p>,</span>                                                      <span class=n>OfficeOpenXml</span><span class=p>.</span><span class=n>Table</span><span class=p>.</span><span class=n>TableStyles</span><span class=p>.</span><span class=n>None</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>pck</span><span class=p>.</span><span class=n>Save</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=最后对比 class=headerLink><a href=#%e6%9c%80%e5%90%8e%e5%af%b9%e6%af%94 class=header-mark></a>最后对比</h2><p>我还用wps手动导入了一次这个csv文件，然后光导入就用了36s。保存估计还要花几秒。而且我的wps是台式机的i3-8100+固态。</p><p>结果说明了python的性能确实不够。最好用的pyexcel需要120s很夸张。最快的pyexcelerate也要60s。<strong>但我用python完成这些代码的过程最快，api好用</strong>。</p><p>c#性能确实很强。代码量也不多，但是我花了最多的时间写出来。文档什么的都太差了。我有想这写一个桌面工具来转换，<strong>我也肯定会用c#来处理</strong>。</p><p>wps应该是c/c++写的，因为加上了gui等等原因，速度竟然不如c#，但还是会比python快不少。足以见得不是一个速度级别。</p><h2 id=总结 class=headerLink><a href=#%e6%80%bb%e7%bb%93 class=header-mark></a>总结</h2><p>各个语言都是有自己的优势。我的抉择是选python。<strong>除非我要做GUI界面</strong>。</p><p>我更喜欢用python来打造原型，完成功能。即使python最慢。现在流行云计算，可以去到云平台写函数，远程调用。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2021-08-23</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=# onclick=return!1 title="分享到 Twitter" data-sharer=twitter data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件 data-hashtags=python,c#><i class="fab fa-twitter fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Facebook" data-sharer=facebook data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-hashtag=python><i class="fab fa-facebook-square fa-fw"></i></a><a href=# onclick=return!1 title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件 data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Line" data-sharer=line data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件><i data-svg-src=/lib/simple-icons/icons/line.min.svg></i></a><a href=# onclick=return!1 title="分享到 微博" data-sharer=weibo data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件><i class="fab fa-weibo fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Myspace" data-sharer=myspace data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件 data-description=我的超级多学习资料，都是通过书签来进行保存的。之前说过好好理一理python，所以打算从python书签开始。python的性能一直被诟病，有多方面的原因。而多进程是解决办法之一><i data-svg-src=/lib/simple-icons/icons/myspace.min.svg></i></a><a href=# onclick=return!1 title="分享到 Blogger" data-sharer=blogger data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件 data-description=我的超级多学习资料，都是通过书签来进行保存的。之前说过好好理一理python，所以打算从python书签开始。python的性能一直被诟病，有多方面的原因。而多进程是解决办法之一><i class="fab fa-blogger fa-fw"></i></a><a href=# onclick=return!1 title="分享到 Evernote" data-sharer=evernote data-url=https://kentxxq.com/contents/csv%E8%BD%ACxlsx%E6%96%87%E4%BB%B6/ data-title=csv转xlsx文件><i class="fab fa-evernote fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/python/>python</a>,&nbsp;<a href=/tags/c/>c</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/contents/%E6%88%91%E7%9A%84%E4%B8%AA%E4%BA%BA%E7%94%B5%E5%AD%90%E4%BA%A7%E5%93%81%E8%B7%AF%E7%BA%BF/ class=prev rel=prev title=我的个人电子产品路线><i class="fas fa-angle-left fa-fw"></i>我的个人电子产品路线</a>
<a href=/contents/centos8%E7%9A%84%E8%AE%B0%E5%BD%95/ class=next rel=next title=centos8的记录>centos8的记录<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>1993 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://kentxxq.com target=_blank rel="noopener noreferrer">kentxxq</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a> | <a target=_blank href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=43010402000934"><img src=/备案图标.png style=display:inline-block>湘公网安备 43010402000934号</a></span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp>湘ICP备2021002319号-1</span></div><div class=footer-line></div><div class=footer-line></div></div><script>'serviceWorker'in navigator&&(navigator.serviceWorker.register('/sw.min.js',{scope:'/'}).then(function(){}),navigator.serviceWorker.ready.then(function(){}))</script></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/fuse/fuse.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/topbar/topbar.min.js></script><script type=text/javascript src=/lib/pjax/pjax.min.js></script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','UA-131319987-1',{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-131319987-1" async></script></div><div class=pjax-assets><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:18},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,useExtendedSearch:!1},sharerjs:!0,twemoji:!0}</script><script type=text/javascript src=/lib/twemoji/twemoji.min.js defer></script><script type=text/javascript src=/js/twemoji.min.js defer></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js defer></script><script type=text/javascript src=/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/js/katex.min.js defer></script><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css></div></body></html>